<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>5</depth>
  <persistent>0</persistent>
  <parentName>obj_ally_parent</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Initialization
npcid = npc_create();

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Declare Dialogue Variables
npc_dialogue[0] = "Welcome, strangeh'.";
npc_dialogue[1] = "What are ya buyin'?";
npc_dialogue[2] = "What are ya sellin'?";
npc_dialogue[3] = "Heh, heh, thank you.";
npc_dialogue[4] = "Ahh... I'll buy it for a high price!";
npc_dialogue[5] = "Not enough cash, strangeh.";
npc_dialogue[6] = "The name's Vakahar. I'm a traveling merchant, and the Khurikash are some of my favorite customers. Now, What can I do for ya?.";
npc_dialogue[7] = "Looks like you've already got your hands full, eh strangeh?";
npc_dialogue[8] = "Come back any time.";
npc_dialogue[9] = "Got some rare things on sale, strangeh'";

pc_dialogue[0] = "Who are you?";
pc_dialogue[1] = "Let me have a look your merchandise![Buy Stuff]";
pc_dialogue[2] = "have a look at this loot![Sell Stuff]";
pc_dialogue[3] = "I'd better be going.";
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Declare Inventory Variables
shop_inv_type[0] = ds_list_create();//Treasure
shop_inv_type[1] = ds_list_create();//Useable
shop_inv_type[2] = ds_list_create();//Weapon
shop_inv_type[3] = ds_list_create();//Armor
shop_inv_type[4] = ds_list_create();//Other/Special

shop_inv_num[0] = ds_list_create();
shop_inv_num[1] = ds_list_create();
shop_inv_num[2] = ds_list_create();
shop_inv_num[3] = ds_list_create();
shop_inv_num[4] = ds_list_create();

ds_list_add(shop_inv_type[0],0);
ds_list_add(shop_inv_num[0],2);

ds_list_add(shop_inv_type[1],0);
ds_list_add(shop_inv_num[1],2);

ds_list_add(shop_inv_type[1],1);
ds_list_add(shop_inv_num[1],2);

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///set variables
npc_name = "Vakahar"
conversing = false;
talking = false;

dlg_log = ds_list_create();
dlg_opts = ds_list_create();
dlg_opt_ids = ds_list_create();
hitpoints = 5;
spd = 3;
dir = 270;
npcdef = 1;
npcdefmod = 0;
knockable = true;
snared = false;
stunned = false;
stealthed = false;

//graphics
spr_ind = 1;
portrait = spr_npcportrait_vakahar;
portrait_emotion = 0;
frame_num = 2;
portrait_ind = 2;
icon = spr_brgnoll_icon;
image_speed = 0;
theme_song = snd_theme_merchant;

//conversation
dlg_over = false;
talk_i = 0;
talk_j = 0;
talk_spd = 2;
talk_char = '';
shop_mode = false;
sell_mode = false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///end dialogue or start shopping
if (shop_mode || sell_mode){
  with dlg_menu {instance_destroy();}//destroy dialogue menu
  shop_menu = instance_create(view_xview,view_yview,obj_menu_shop);//create shop menu
  shop_menu.mode = shop_mode;//shop_mode = true, sell_mode = false;
  shop_menu.target_npc = id;
  shop_menu.display_dlg = shop_dlg_append(npc_dialogue[1+sell_mode]);
  with (shop_menu){
    //load item data
    event_user(0);
  }
}else{
  sound_stop(theme_song);
  sound_loop(snd_lair);
  end_dialogue(id,dlg_menu);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="12">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Start Conversation

//play theme song
sound_stop(snd_lair);
sound_loop(theme_song);

//look at speaker
dir = point_direction(x,y,ds_list_find_value(dlg_menu.participants,0).x,ds_list_find_value(dlg_menu.participants,0).y);

//determine opening phrase
ds_list_copy(dlg_log,dialogue_log_append(npc_dialogue[0]));
log_pcount = (ds_list_size(dlg_log) div dlg_menu.logwin_lnum) + ((ds_list_size(dlg_log) mod dlg_menu.logwin_lnum) &gt;0);
//determine starting options
ds_list_clear(dlg_opts);
ds_list_add(dlg_opts,pc_dialogue[0]);
ds_list_add(dlg_opts,pc_dialogue[1]);
ds_list_add(dlg_opts,pc_dialogue[2]);
ds_list_add(dlg_opts,pc_dialogue[3]);
//assign retrieval keys
ds_list_clear(dlg_opt_ids);
ds_list_add(dlg_opt_ids,0);
ds_list_add(dlg_opt_ids,1);
ds_list_add(dlg_opt_ids,2);
ds_list_add(dlg_opt_ids,3);

talking = true;
talk_spd = 2;
ds_list_clear(dlg_menu.display_log);
ds_list_add(dlg_menu.display_log,"");
alarm[1] = talk_spd;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Dialogue Click
//Check if this NPC is in a conversation
if ((conversing) &amp;&amp; !(shop_mode || sell_mode))
    {
    if (dlg_menu.position_x == 0) &amp;&amp; (talking == false) &amp;&amp; !(dlg_over)
        {
        talking = true;
        ds_list_clear(dlg_menu.display_log);
        ds_list_add(dlg_menu.display_log,"");
        dlg_menu.log_ind = 0;
        dlg_menu.log_page = 1;
        switch(ds_list_find_value(dlg_opt_ids,dlg_menu.hovered.key))
            {
            case 0:
                //respond
                dlg_log = dialogue_log_append(npc_dialogue[6]);
                //determine new options
                ds_list_clear(dlg_opts);
                ds_list_add(dlg_opts,pc_dialogue[0]);
                ds_list_add(dlg_opts,pc_dialogue[1]);
                ds_list_add(dlg_opts,pc_dialogue[2]);
                ds_list_add(dlg_opts,pc_dialogue[3]);
                ds_list_clear(dlg_opt_ids);
                ds_list_add(dlg_opt_ids,0);
                ds_list_add(dlg_opt_ids,1);
                ds_list_add(dlg_opt_ids,2);
                ds_list_add(dlg_opt_ids,3);
                break;
            
            case 1:
                //respond
                dlg_log = dialogue_log_append(npc_dialogue[1]);
                //open shop menu
                ds_list_clear(dlg_opts);
                talking = true;
                dlg_over = true;
                shop_mode = true;
                break;
            
            case 2:
                //respond
                dlg_log = dialogue_log_append(npc_dialogue[2]);
                //open pawn menu
                ds_list_clear(dlg_opts);
                talking = true;
                dlg_over = true;
                sell_mode = true;
                break;
            
            case 3:
                //respond
                dlg_log = dialogue_log_append(npc_dialogue[8]);
                //end dialogue
                ds_list_clear(dlg_opts);
                talking = true;
                dlg_over = true;
                break;
            }
        log_pcount = (ds_list_size(dlg_log) div dlg_menu.logwin_lnum) + ((ds_list_size(dlg_log) mod dlg_menu.logwin_lnum) &gt;0);
        alarm[1] = talk_spd;
        with dlg_menu
            {
            ds_list_clear(option_objects);
            with obj_menu_dlg_option
                {
                instance_destroy();
                }
            }
        }
    }
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
